<?xml version="1.0" encoding="utf-8"?>
<mdscript name="uncharted_sectors" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
	<cues>
		
		<!-- Activates on every Game Start -->
		<!-- Make sure it only fires up on the Main Galaxy -->
		<cue name="Start" version="3">
			<conditions>
				<event_cue_signalled cue="md.Setup.Start" />
				<check_value value="player.galaxy.macro == macro.xu_ep2_universe_macro" comment="only in main-galaxy" />
			</conditions>
			
			<!-- Find all needed Sectors and save their address for later (Clusters are not needed here) -->
			<actions>
				
				<!-- Matrix #79B          -->	<find_sector macro="macro.cluster_33_sector001_macro"  space="player.galaxy"                             required="true" name="$Matrix79_b_Sector"       />
				<!-- Matrix #79A          -->	<find_sector macro="macro.cluster_819_sector001_macro" space="player.galaxy"                             required="true" name="$Matrix79_a_Sector"       />
				<!-- Menelaus' Oasis      -->	<find_sector macro="macro.cluster_609_sector001_macro" space="player.galaxy" extension="'ego_dlc_boron'" required="true" name="$MenelausOasisSector"     />
				<!-- Barren Shores        -->	<find_sector macro="macro.cluster_602_sector001_macro" space="player.galaxy" extension="'ego_dlc_boron'" required="true" name="$BarrenShoresSector"      />
				<!-- Family Kritt         -->	<find_sector macro="macro.cluster_402_sector001_macro" space="player.galaxy" extension="'ego_dlc_split'" required="true" name="$KrittSector"             />
				<!-- Light Water          -->	<find_sector macro="macro.cluster_801_sector001_macro" space="player.galaxy"                             required="true" name="$Unclaimed_South_Sector"  />
				<!-- Fifth Cascade        -->	<find_sector macro="macro.cluster_802_sector001_macro" space="player.galaxy"                             required="true" name="$Unclaimed_North_Sector"  />
				<!-- Shore of Infinity    -->	<find_sector macro="macro.cluster_805_sector001_macro" space="player.galaxy"                             required="true" name="$ShoreOfInfinity_Sector"  />
				<!-- Mists of Elysium I   -->	<find_sector macro="macro.cluster_810_sector001_macro" space="player.galaxy"                             required="true" name="$MistsOfElysium_1_Sector" />
				<!-- Mists of Elysium II  -->	<find_sector macro="macro.cluster_811_sector001_macro" space="player.galaxy"                             required="true" name="$MistsOfElysium_2_Sector" />
				<!-- Mists of Elysium III -->	<find_sector macro="macro.cluster_812_sector001_macro" space="player.galaxy"                             required="true" name="$MistsOfElysium_3_Sector" />
				<!-- Matrix 598           -->	<find_sector macro="macro.cluster_415_sector001_macro" space="player.galaxy" extension="'ego_dlc_split'" required="true" name="$MatrixSector"            />
				
			</actions>
			<patch  sinceversion="3">
				
				
				<!-- Locate Sectors -->
				<find_sector macro="macro.cluster_415_sector001_macro" space="player.galaxy" extension="'ego_dlc_split'" required="true" name="$MatrixSector"/>
				<find_sector macro="macro.cluster_604_sector001_macro" space="player.galaxy" extension="'ego_dlc_boron'" required="true" name="$OceanSector"/>
				
				<!-- ReRoute Gates - Matrix 598 -->
				<find_gate name="$Matrix_Gates" multiple="true" space="$MatrixSector"/>
				<do_for_each name="$g" in="$Matrix_Gates">
					<do_if value=" ($g.exit.exists) and ($g.exit.sector == $OceanSector)">
						<set_object_active object="$g" activate="false" />
					</do_if>
				</do_for_each>
				
				<!-- ReRoute Gates - Ocean of Fantasy -->
				<find_gate name="$Ocean_Gates" multiple="true" space="$OceanSector"/>
				<do_for_each name="$g" in="$Ocean_Gates">
					<do_if value=" ($g.exit.exists) and ($g.exit.sector == $MatrixSector)">
						<set_object_active object="$g"  activate="false" />
					</do_if>
				</do_for_each>
				
				<reset_cue cue="Start"/>
				
			</patch>
			<cues>
				
				<!-- Condition - Sector Discovered -->
				<cue name="Matrix79_A_PlayerDiscovered_Check" onfail="cancel">
					<conditions>
						<check_value value="$Matrix79_a_Sector.isknown"/>
					</conditions>
				</cue>
				<cue name="Matrix79_B_PlayerDiscovered_Check" onfail="cancel">
					<conditions>
						<check_value value="$Matrix79_b_Sector.isknown"/>
					</conditions>
				</cue>
				<cue name="MenelausOasis_PlayerDiscovered_Check" onfail="cancel">
					<conditions>
						<check_value value="$MenelausOasisSector.isknown"/>
					</conditions>
				</cue>
				<cue name="MistsOfElysium_PlayerDiscovered_Check" onfail="cancel">
					<conditions>
						<check_value value="$MistsOfElysium_2_Sector.isknown"/>
					</conditions>
				</cue>
				<cue name="FifthCascade_PlayerDiscovered_Check" onfail="cancel">
					<conditions>
						<check_value value="$Unclaimed_North_Sector.isknown"/>
					</conditions>
				</cue>
				<cue name="LightWater_PlayerDiscovered_Check" onfail="cancel">
					<conditions>
						<check_value value="$Unclaimed_South_Sector.isknown"/>
					</conditions>
				</cue>
				
				<!-- Events to find out what is happening -->
				<cue name="Matrix79_PlayerDiscovered_Event">
					<conditions>
						<check_any>
							<event_object_known_to_player object="$Matrix79_a_Sector"/>
							<event_object_known_to_player object="$Matrix79_b_Sector"/>
							<event_cue_completed cue="Matrix79_A_PlayerDiscovered_Check"/>
							<event_cue_completed cue="Matrix79_B_PlayerDiscovered_Check"/>
						</check_any>
					</conditions>
					<actions>
						<find_gate name="$Matrix79_B_Gates" multiple="true" space="$Matrix79_b_Sector" active="false" />
						<do_for_each name="$g" in="$Matrix79_B_Gates">
							<do_if value=" ($g.exit.exists) and ($g.exit.sector == $Matrix79_a_Sector)">
								<set_object_active object="$g" />
							</do_if>
						</do_for_each>
						<remove_value name="$Matrix79_B_Gates" />
					</actions>
				</cue>
				<cue name="MistsOfElysium_PlayerDiscovered_Event">
					<conditions>
						<check_any>
							<event_object_known_to_player object="$MistsOfElysium_2_Sector"/>
							<event_cue_completed cue="MistsOfElysium_PlayerDiscovered_Check"/>
						</check_any>
					</conditions>
					<actions>
						<find_gate name="$Hidden_1_Gates" multiple="true" space="$MistsOfElysium_1_Sector" active="false" />
						<do_for_each name="$g" in="$Hidden_1_Gates">
							<set_object_active object="$g" />
						</do_for_each>
						<find_gate name="$Hidden_3_Gates" multiple="true" space="$MistsOfElysium_3_Sector" active="false" />
						<do_for_each name="$g" in="$Hidden_3_Gates">
							<set_object_active object="$g" />
						</do_for_each>
						<remove_value name="$Hidden_1_Gates" />
						<remove_value name="$Hidden_3_Gates" />
					</actions>
				</cue>
				<cue name="MenelausOasis_PlayerDiscovered_Event">
					<conditions>
						<check_any>
							<event_object_known_to_player object="$MenelausOasisSector"/>
							<event_cue_completed cue="MenelausOasis_PlayerDiscovered_Check"/>
						</check_any>
					</conditions>
					<actions>
						<find_gate name="$BarrenShoresGates" multiple="true" space="$BarrenShoresSector" />
						<do_for_each name="$g" in="$BarrenShoresGates">
							<do_if value=" ($g.exit.exists) and ($g.exit.sector == $KrittSector)">
								<set_object_active object="$g" />
							</do_if>
						</do_for_each>
						<remove_value name="$BarrenShoresGates" />
					</actions>
				</cue>
				<cue name="FifthCascade_PlayerDiscovered_Event">
					<conditions>
						<check_any>
							<event_object_known_to_player object="$Unclaimed_North_Sector"/>
							<event_cue_completed cue="FifthCascade_PlayerDiscovered_Check"/>
						</check_any>
					</conditions>
					<actions>
						<find_gate name="$FifthCascadeGates" multiple="true" space="$Unclaimed_North_Sector" />
						<do_for_each name="$g" in="$FifthCascadeGates">
							<do_if value=" ($g.exit.exists) and ($g.exit.sector == $MatrixSector)">
								<set_object_active object="$g" />
							</do_if>
						</do_for_each>
						<remove_value name="$FifthCascadeGates" />
					</actions>
				</cue>
				<cue name="LightWater_PlayerDiscovered_Event">
					<conditions>
						<check_any>
							<event_object_known_to_player object="$Unclaimed_South_Sector"/>
							<event_cue_completed cue="LightWater_PlayerDiscovered_Check"/>
						</check_any>
					</conditions>
					<actions>
						<find_gate name="$LightWaterGates" multiple="true" space="$Unclaimed_South_Sector" />
						<do_for_each name="$g" in="$LightWaterGates">
							<do_if value=" ($g.exit.exists) and ($g.exit.sector == $ShoreOfInfinity_Sector)">
								<set_object_active object="$g" />
							</do_if>
						</do_for_each>
						<remove_value name="$LightWaterGates" />
					</actions>
				</cue>
				
			</cues>
		</cue>
		
	</cues>
</mdscript>
